import pandas as pd


def clean_excel(input_file, output_file, column_name, codes_to_remove):
    """
    Removes rows from an Excel sheet based on a list of codes.

    Parameters:
        input_file (str): Path to the input Excel file.
        output_file (str): Path to save the cleaned Excel file.
        column_name (str): The name of the column to search for the codes.
        codes_to_remove (list): List of codes to be removed from the specified column.
    """
    # Load the Excel file
    df = pd.read_excel(input_file, sheet_name=sheet_name)
    df[column_name] = df[column_name].astype(str)
    # Filter out rows where the column contains any of the codes
    df_cleaned = df[~df[column_name].isin(codes_to_remove)]

    # Save the cleaned data back to a new Excel file
    df_cleaned.to_excel(output_file, index=False)

    print(f"Cleaned file saved as {output_file}")


# Example usage
input_file = r"D:\Back up 29.11.2023\Paradise Charity\March 2025\LatePayments-2025-03-15.xlsx"  # Change this to your file path
output_file = r"D:\Back up 29.11.2023\Paradise Charity\March 2025\LatePaymentsCleaned.xlsx"  # Change this to your desired output file
sheet_name = "Sheet1"  # Change this to the specific sheet name
column_name = "SponsorFileNumber"  # Change this to the actual column name
codes_to_remove = [
    "900132",
    "900138",
    "900502",
    "900537",
    "900822",
    "900840",
    "902128",
    "902270",
    "903526",
    "904451",
    "904511",
    "904625",
    "904900",
    "900051",
    "900251",
    "900482",
    "900527",
    "900528",
    "900671",
    "901074",
    "901075",
    "901084",
    "901092",
    "901117",
    "901124",
    "901217",
    "901243",
    "901295",
    "901304",
    "901495",
    "901508",
    "901527",
    "901552",
    "901681",
    "901862",
    "901877",
    "901925",
    "902103",
    "902951",
    "902583",
    "902873",
    "902876",
    "902934",
    "902955",
    "902974",
    "903018",
    "903027",
    "903031",
    "903157",
    "903187",
    "903345",
    "903416",
    "903440",
    "903470",
    "903476",
    "903478",
    "903547",
    "903599",
    "903679",
    "903686",
    "903741",
    "903744",
    "903745",
    "903747",
    "903775",
    "903795",
    "903806",
    "904034",
    "904128",
    "904159",
    "904214",
    "904254",
    "904283",
    "904313",
    "904323",
    "904362",
    "904386",
    "904389",
    "904390",
    "904430",
    "904438",
    "904442",
    "904452",
    "904455",
    "904499",
    "904535",
    "904563",
    "904565",
    "904601",
    "904613",
    "904614",
    "904689",
    "904690",
    "904691",
    "904702",
    "904726",
    "904746",
    "904777",
    "904793",
    "904870",
    "904884",
    "904895",
    "904908",
    "904950",
    "904973",
    "904974",
    "904977",
    "905007",
    "905018",
    "905021",
    "905027",
    "905029",
    "905034",
    "905037",
    "905049",
    "905061",
    "905064",
    "905069",
    "905112",
    "905191",
    "905199",
    "905259",
    "905260",
    "905272",
    "905295",
    "905329",
    "905354",
    "905413",
    "905523",
    "900054",
    "900326",
    "902267",
    "904589",
    "900110",
    "902555",
    "903537",
    "903921",
    "904118",
    "904334",
    "904852",
    "904936",
    "905682",
    "903605",
    "904495",
    "905755",
]  # List of codes to remove

clean_excel(input_file, output_file, column_name, codes_to_remove)
